<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Angular Controllers</title>
    <!-- Add Angular CDN below -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>
    <style>

    </style>
</head>
<body ng-app="myApp">
<div ng-controller="formController as fc">
    <div>
        First Name: <input type="text" ng-model="fc.student.fName"><br><br>
        Last Name: <input type="text" ng-model="fc.student.lName"><br><br>
        Email: <input type="text" ng-model="fc.student.email"><br><br>
        <textarea ng-model="fc.student.comments"  ng-disabled="fc.noRemainingChars()"></textarea> <!--disable the textarea if the max amount of characters have been used-->
        <p>Characters remaining {{ fc.remainingChars() }}</p><br>
        <!--Add a button after the textarea that calls the add function when clicked-->
        <button ng-click="fc.addStudent()">Add Student</button>
        <div ng-controller="tableController as tc">
            <p>Total Entries: {{ tc.tableEntries() }}</p>
            <table> <!-- Full Name, Email, and Comments-->
                <tbody>
                <tr>
                    <th>Full Name</th>
                    <th>Email</th>
                    <th>Comments</th>
                </tr>
                <tr ng-repeat='student in formArray'>
                    <td>{{ student.fName + "" + student.lName }}</td>
                    <td>{{ student.email }}</td>
                    <td>{{ student.comments }}</td>
                    <td><button ng-click="tc.removeRow($index)">Delete</button>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<script>
    // Feature Set 1 - Adding Control
    // Feature Set 2 - Making it functional
    // Feature Set 4 - Multiple Controllers
    var app = angular.module('myApp', []);

    app.controller("formController",function($scope){
        this.student = {
            'comments' : ''
        };
        $scope.formArray = [];
        // add another method that adds the form object to the formArray
        this.addStudent = function(){
            $scope.formArray.push(this.student);
            console.log("formArray ",$scope.formArray);
            this.student = {};
            // Feature Set 3 - Keeping it Short
            // reset the textarea after the form object has been added to the infoArray
            this.student.comments = '';
        };

        //method to your controller that returns true if remaining characters <= 0 and false for everything else
        this.noRemainingChars = function(){
            if (this.remainingChars() <= 0){
                return true;
            } else {
                return false;
            }
        };
        this.maxLength = 25;
        /*
         method returns the total number of characters still available for the comment
         */
        this.remainingChars = function(){
            console.log('comments length '+this.student.comments.length);
            return this.maxLength - this.student.comments.length;
        };

    });

    // new controller
    app.controller("tableController",function($scope){
        //remove object from formArray
        this.removeRow = function(rowIndex){
            console.log('removeRow');
            $scope.formArray.splice(rowIndex,1);
        };
        //remove object from formArray
        this.tableEntries = function(){
            console.log('tableEntries method ', $scope.formArray.length);
            return $scope.formArray.length;
        };

    });


</script>
</body>
</html>
